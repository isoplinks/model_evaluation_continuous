{
    "collab_server" : "",
    "contents" : "require(export)\nrequire(ggplot2)\nrequire(grid)\nrequire(gridExtra)\nrequire(gpairs)\n#[1] d.True model\\n Turnover PD                                           \n#[2] a.Misspecified delay\\n Immediate effect                              \n#[3] b.Misspecified delay\\n Effect compartment                            \n#[4] c.Misspecified delay and correlation\\n Effect compartment, Full Omega\nnpdex <- read.csv(\"npdex.csv\")\nnpdepredx <- read.csv(\"npdepredx.csv\")\nobsnpde <- read.csv(\"obsnpde.csv\")\nnpccal <- read.csv(\"npccal.csv\")\nobs <- read.csv(\"obs.csv\")\n\ngof <- read.csv(\"gof.csv\")\nPCDATAmNOPRED <- read.csv(\"PCDATAmNOPRED.csv\")\n\nsource(\"stat_plsmo_new.R\")\n\nrichpredipred <- read.csv(\"richpredipred.csv\")\nnames(richpredipred) <- c(\"ID\",\"IVAR\",\"IPRED\",\"DV\",\"PRED\",\"ModelName\")\neta1 <- read.csv(\".\\\\1\\\\Etacov.csv\")\neta2 <- read.csv(\".\\\\2\\\\Etacov.csv\")\neta3 <- read.csv(\".\\\\3\\\\Etacov.csv\")\neta4 <- read.csv(\".\\\\4\\\\Etacov.csv\")\n\nindividualfitsplot2 <- function (richpredipred=richpredipred,ModelName=\"All\", ...)\n{\n  ModelName=ModelName\n  if(ModelName==\"All\") {\n    gofID <- richpredipred[\n      richpredipred$ID%in%c(0,21,15), ]\n  }\n  if(ModelName!=\"All\") {\n    gofID <- richpredipred[\n      richpredipred$ID%in%c(0,21,15), ]\n    gofID<- gofID[is.element(gofID$ModelName,ModelName ),]\n    \n  }\n  \n  individualfitexample<- ggplot(gofID ,aes(IVAR,DV))+\n    geom_point(color=\"blue\",size=2)+\n    geom_line(aes(y=IPRED),col=\"green\")+\n    geom_line(aes(y=PRED),col=\"red\")+\n    facet_grid (~ID)+\n    scale_x_continuous(breaks=seq(0,144,24))+\n    ylab(\"OBS/IPRED/PRED\")+xlab(\"Time (h)\")+\n    theme(legend.position=\"none\",axis.text=element_text(size=12),\n          axis.title=element_text(size=14))+\n    theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n    theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n    theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n    theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\n  \n  individualfitexample\n  if(ModelName==\"All\")\n    individualfitexample <- individualfitexample+\n    facet_grid (ModelName~ID)\n  individualfitexample <- arrangeGrob(individualfitexample,ncol=1)\n  grid.draw(individualfitexample)\n  return(individualfitexample)\n}\n\n\n\n#ModelName=\"All\"\nbasiggofplot1 <- function (gofdata=gof,ModelName=\"All\", ...)\n{\n # gofdata<- gof\n # ModelName=\"All\"\n  ModelName=ModelName\n  \nif(ModelName==\"All\") {\n  gofplot <- gofdata[gofdata$ObsName!=\"CObs\",]\n  \n}\n  # ModelName=\"d.True model\\n Turnover PD\"\n  \n  if(ModelName!=\"All\") {\n    gofplot <- gofdata[gofdata$ObsName!=\"CObs\"&\n                         is.element(gofdata$ModelName,ModelName ),]\n    \n  }\n  \n  \nfig1a <- ggplot(gofplot,aes(PRED,DV))+\n  geom_point(color=\"blue\")+\n  geom_abline(intercept=0,slope=1,size=1)+\n  stat_plsmo(color=\"red\",size=1.5,linetype=\"dashed\")+\n  ylab(\"OBS\")+ xlab(\"PPRED\")+\n  scale_y_continuous(breaks=seq(0,120,20))+scale_x_continuous(breaks=seq(0,120,20))+\n  theme(plot.title = element_text(size=16, face=\"bold\"))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"nonne\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\n\nif(ModelName==\"All\")\n  fig1a <- fig1a+\n  facet_grid (~ModelName)+\n  ggtitle(\"(A)\")\n  \nfig1d   <-  ggplot(gofplot ,aes(IPRED,DV))+\n  geom_point(color=\"blue\")+\n  geom_abline(intercept=0,slope=1,size=1)+\n  stat_plsmo(color=\"red\",size=1.5,linetype=\"dashed\")+\n  ylab(\"OBS\")+ xlab(\"IPRED\")+\n  scale_y_continuous(breaks=seq(0,120,20))+scale_x_continuous(breaks=seq(0,120,20))+\n  theme(plot.title = element_text(size=16, face=\"bold\"))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"nonne\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1) \n\nif(ModelName==\"All\")\n  fig1d <- fig1d+\n  facet_grid (~ModelName)+\n  ggtitle(\"  \")\n\nfig1 <- arrangeGrob(fig1a,fig1d,ncol=1)\ngrid.draw(fig1)\nreturn(fig1)\n}\n\nbasiggofplot2 <- function (gofdata=gof,ModelName=\"All\", ...)\n{\n  \n  ModelName=ModelName\n  \n  if(ModelName==\"All\") {\n    gofplot <- gofdata[gofdata$ObsName!=\"CObs\",]\n    \n  }\n  if(ModelName!=\"All\") {\n    gofplot <- gofdata[gofdata$ObsName!=\"CObs\"&\n                         is.element(gofdata$ModelName,ModelName ),]\n    \n  }\n  \n  \n\nfig1c   <- ggplot(gofplot ,aes(IVAR,PCWRES))+ \n  geom_point(color=\"blue\")+\n  geom_abline(intercept=0,slope=0,size=1)+\n  stat_plsmo(color=\"red\",size=1.5,linetype=\"dashed\")+\n  ylab(\"PWRES\")+ xlab(\"TIME\")+\n  scale_y_continuous(breaks=seq(-5,5,1))+scale_x_continuous(breaks=seq(0,144,24))+\n  \n  theme(plot.title = element_text(size=16, face=\"bold\"))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"nonne\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\n\nif(ModelName==\"All\")\n  fig1c <- fig1c+\n  facet_grid (~ModelName)+\n  ggtitle(\"(B)\")\n\n\n\nfig1f <- ggplot(gofplot,aes(IVAR,IWRES))+\n  geom_point(color=\"blue\")+\n  geom_abline(intercept=0,slope=0,size=1)+\n  stat_plsmo(color=\"red\",size=1.5,linetype=\"dashed\")+\n  ylab(\"IWRES\")+ xlab(\"TIME\")+\n  scale_y_continuous(breaks=seq(-5,5,1))+scale_x_continuous(breaks=seq(0,144,24))+\n  theme(plot.title = element_text(size=16, face=\"bold\"))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"nonne\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\n\nif(ModelName==\"All\")\n  fig1f <- fig1f+\n  facet_grid (~ModelName)+\n  ggtitle(\" \")\nfig1 <- arrangeGrob(fig1c,fig1f,ncol=1)\ngrid.draw(fig1)\nreturn(fig1)\n}\n\n\nbasiggofplot3 <- function (gofdata=gof,ModelName=\"All\",logx=FALSE, ...)\n{\n  \n  ModelName=ModelName\n  \n  if(ModelName==\"All\") {\n    gofplot <- gofdata[gofdata$ObsName!=\"CObs\",]\n    \n  }\n  if(ModelName!=\"All\") {\n    gofplot <- gofdata[gofdata$ObsName!=\"CObs\"&\n                         is.element(gofdata$ModelName,ModelName ),]\n    \n  }\n  \n\n\n\nfig1b <-  ggplot(gofplot ,aes(PRED,PCWRES))+\n  geom_point(color=\"blue\")\nif(!logx)  {\n  fig1b <-fig1b+\n    geom_abline(intercept=0,slope=1,size=1)\n}\n  if(logx)  {\n    fig1b <-fig1b+\n      geom_abline(intercept=0,slope=log(1),size=1)\n  }\n  \n  fig1b <- fig1b+\n    stat_plsmo(color=\"red\",size=1.5,linetype=\"dashed\")+\n    ylab(\"PWRES\")+ xlab(\"PPRED\")+\n  scale_y_continuous(breaks=seq(-5,5,1))+scale_x_continuous(breaks=seq(0,120,20))+\n  theme(plot.title = element_text(size=16, face=\"bold\"))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"nonne\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\nif(ModelName==\"All\")\n  fig1b <- fig1b+\n  facet_grid (~ModelName)+\n  ggtitle(\"(C)\")\n\n  if(logx)  {\n    fig1b <-fig1b+\n      scale_x_log10()+\n      xlab(\"log(PPRED)\")\n  }\n\nfig1e   <-  ggplot(gofplot ,aes(IPRED,IWRES))+\n  geom_point(color=\"blue\")\nif(!logx)  {\n  fig1e <-fig1e+\n    geom_abline(intercept=0,slope=1,size=1)\n}\nif(logx)  {\n  fig1e <-fig1e+\n    geom_abline(intercept=0,slope=log(1),size=1)\n}\n\nfig1e <- fig1e+\n  stat_plsmo(color=\"red\",size=1.5,linetype=\"dashed\")+\n  ylab(\"IWRES\")+ xlab(\"IPRED\")+\n  scale_y_continuous(breaks=seq(-5,5,1))+scale_x_continuous(breaks=seq(0,100,20))+\n  theme(plot.title = element_text(size=16, face=\"bold\"))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"nonne\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\n\nif(logx)  {\n  fig1e <-fig1e+\n    scale_x_log10()+\n    xlab(\"log(IPRED)\")\n}\n\nif(ModelName==\"All\")\n  fig1e <- fig1e+\n  facet_grid (~ModelName)+\n  ggtitle(\"  \")\n\n\nfig1 <- arrangeGrob(fig1b,fig1e,ncol=1)\ngrid.draw(fig1)\nreturn(fig1)\n}\n\nvpcplotpredcorr <- function (PCDATAm=PCDATAm,ModelName=\"All\", ...)\n{\n  ModelName=ModelName\n    if(ModelName==\"All\") {\n    PCDATAmplot <- PCDATAm[PCDATAm$ObsName==\"EObs\",]\n  }\n  if(ModelName!=\"All\") {\n    PCDATAmplot <- PCDATAm[PCDATAm$ObsName==\"EObs\"&\n                         is.element(PCDATAm$ModelName,ModelName ),]\n    \n  }\n  \nvpcplot<- ggplot(PCDATAmplot ,\n       aes(t,`X50._DVPLOT`,ymin=`X2.5._DVPLOT`,ymax=`X97.5._DVPLOT`,\n           fill=QI,col=QI))+\n  geom_ribbon(alpha=0.1,col=NA ) +\n  geom_point(data=obs[obs$ObsName==\"EObs\",],aes(x=t,y=DV ),color=\"black\",inherit.aes = FALSE,shape=1)+\n  geom_line( ,size=1.5) +\n  geom_line(aes(y=`X.._DVPLOT`,linetype=observed),color=\"black\") +\n  scale_linetype_manual(  name=\"Observerd (dashed lines)\",breaks=c(\"Observed\"),values=c(\"dashed\"))+\n  scale_colour_manual(name=\"Prediction Intervals 95% CI (ribbons)\\n Median Predictions (solid lines)\",\n                      breaks=c(\"05%\",\"50%\",\"95%\"),values=c(\"#2c7fb8\",\"#df65b0\",\"#2c7fb8\"))+\n  scale_fill_manual  (name=\"Prediction Intervals 95% CI (ribbons)\\n Median Predictions (solid lines)\",\n                      breaks=c(\"05%\",\"50%\", \"95%\"),values=c(\"blue\",\"red\",\"blue\"))+\n  ylab(\"Predictions\\nObservations\")+ xlab(\"Time (h)\")+\n  scale_y_continuous(breaks=seq(0,120,20))+scale_x_continuous(breaks=seq(0,144,24))+\n  theme(legend.position=\"none\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)+\n  theme(plot.title = element_text(size=16, face=\"bold\"))\n\nif(ModelName==\"All\")\n  vpcplot <- vpcplot+\n  facet_grid (~ModelName)+\n  ggtitle(\"(A)\")\n\nvpcplot <- arrangeGrob(vpcplot,ncol=1)\ngrid.draw(vpcplot)\nreturn(vpcplot)\n}\n\nnpdeplot1 <- function (npdex=npdex,ModelName=\"All\", ...)\n{\n  ModelName=ModelName\n  if(ModelName==\"All\") {\n    npdexplot <- npdex\n  }\n  if(ModelName!=\"All\") {\n    npdexplot <- npdex[is.element(npdex$ModelName,ModelName ),]\n  }\n   \n  \nnpdeplotobj <-  ggplot(npdexplot ,aes(x=Time,y=median))+\n  geom_ribbon(aes(ymin=CIlower,ymax=CIupper,fill=PI,col=PI),alpha=0.1,col=NA)+\n  geom_point(data=obsnpde,aes(x=x,y=y),shape=1)+\n  geom_line(aes(y=theomedian,group=PI,col=PI),size=1.5) +\n  geom_line(aes(group=PI),linetype=\"dashed\",color=\"black\") +\n  scale_colour_manual(values=c(\"#2c7fb8\",\"#df65b0\",\"#2c7fb8\"),guide=F)+\n  scale_fill_manual(name=\"Prediction Intervals 95% CI (ribbons)\\n Median Predictions (solid lines)\",\n                    breaks=c(\"10% percentile\",\"50% percentile\",\"90% percentile\"),values=c(\"blue\",\"red\",\"blue\"),guide=F)+\n  ylab(\"NPD\\n\")+ xlab(\"Time (h)\")+\n  scale_y_continuous(breaks=c(0,seq(-3.5,3.5,1)) ) +\n  scale_x_continuous(breaks=seq(0,144,24) )+\n  theme(legend.position=\"none\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n    theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(strip.text = element_text(size = 14, colour = \"black\"),aspect.ratio=1)\ntheme(plot.title = element_text(size=16, face=\"bold\"))\n\nif(ModelName==\"All\")\n  npdeplotobj <- npdeplotobj+\n  facet_grid (~ModelName)+\n  ggtitle(\"(A)\")\n\nnpdeplot <- arrangeGrob(npdeplotobj,ncol=1)\ngrid.draw(npdeplot)\nreturn(npdeplot)\n}\n\n\n\n\nnpdeplot2 <- function (npdepredx=npdepredx,ModelName=\"All\", logx=FALSE,...)\n{\n  ModelName=ModelName\n  if(ModelName==\"All\") {\n    npdepredxplot <- npdepredx\n  }\n  if(ModelName!=\"All\") {\n    npdepredxplot <- npdepredx[is.element(npdepredx$ModelName,ModelName ),]\n  }\n  npdepredplotobj<-  ggplot(npdepredxplot ,aes(x=Time,y=median))+\n    geom_ribbon(aes(ymin=CIlower,ymax=CIupper,fill=PI,col=PI),alpha=0.1,col=NA)+\n    geom_point(data=obsnpde,aes(x=PRED,y= y),shape=1,color=\"black\",inherit.aes = FALSE)+\n    \n    geom_line(aes(y=theomedian,group=PI,col=PI),size=1.5) +\n    geom_line(aes(group=PI),linetype=\"dashed\",color=\"black\") +\n    scale_colour_manual(values=c(\"#2c7fb8\",\"#df65b0\",\"#2c7fb8\",\"blue\",\"red\",\"blue\"),guide=F)+\n    scale_fill_manual(name=\"Prediction Intervals 95% CI (ribbons)\\n Median Predictions (solid lines)\",\n                      breaks=c(\"5% percentile\",\"50% percentile\",\"95% percentile\"),values=c(\"blue\",\"red\",\"blue\"),guide=F)+\n    ylab(\"NPD\\n\")+ xlab(\"PPRED\")+\n    scale_y_continuous(breaks=c(0,seq(-3.5,3.5,1)) ) +\n    scale_x_continuous(breaks=seq(0,100,20) ) +\n    theme(legend.position=\"none\",axis.text=element_text(size=12),\n          axis.title=element_text(size=14))+\n    theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n    theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n    theme(strip.text = element_text(size = 14, colour = \"black\"),aspect.ratio=1)\n  theme(plot.title = element_text(size=16, face=\"bold\"))\n  \n  if(logx)  {\n    npdepredplotobj <-npdepredplotobj+\n      scale_x_log10()+\n      xlab(\"log(PPRED)\")\n    }\n\n  if(ModelName==\"All\")\n    npdepredplotobj <- npdepredplotobj+\n    facet_grid (~ModelName)+\n    ggtitle(\"(B)\")\n  npdeplot <- arrangeGrob(npdepredplotobj,ncol=1)\n  grid.draw(npdeplot)\n  return(npdeplot)\n}\n\nindividualfitsplot <- function (gof=gof,ModelName=\"All\", ...)\n{\n  ModelName=ModelName\n  if(ModelName==\"All\") {\n    gofID <- gof[\n      gof$ObsName==\"EObs\"&\n        gof$ID%in%c(0,21,15), ]\n    }\n  if(ModelName!=\"All\") {\n    gofID <- gof[\n      gof$ObsName==\"EObs\"&\n        gof$ID%in%c(0,21,15), ]\n    gofID<- gofID[is.element(gofID$ModelName,ModelName ),]\n    \n    }\n\nindividualfitexample<- ggplot(gofID ,aes(IVAR,DV))+\n  geom_point(color=\"blue\",size=2)+\n  geom_line(aes(y=IPRED),col=\"green\")+\n  geom_line(aes(y=PRED),col=\"red\")+\n  facet_grid (~ID)+\n  scale_x_continuous(breaks=seq(0,144,24))+\n  ylab(\"OBS/IPRED/PRED\")+xlab(\"Time (h)\")+\n  theme(legend.position=\"none\",axis.text=element_text(size=12),\n        axis.title=element_text(size=14))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 12, colour = \"black\"),aspect.ratio=1)\n\nindividualfitexample\nif(ModelName==\"All\")\n  individualfitexample <- individualfitexample+\n  facet_grid (ModelName~ID)\nindividualfitexample <- arrangeGrob(individualfitexample,ncol=1)\ngrid.draw(individualfitexample)\nreturn(individualfitexample)\n}\n\n#ggsave(\".\\\\figgoftrue.pdf\",figtrue,width=25,height=16.7,units=\"cm\",dpi=300)\n\n#tmat <- matrix(unlist(goftrueETA) ,ncol=3,byrow=FALSE ) #individual etas\n#var <- diag(c(0.001978949,0.013822067\t,0.13725865))\n#var.eig <- eigen(var)\n#xmat <- var.eig$vectors %*% diag(sqrt(var.eig$values)) %*% solve(var.eig$vectors)\n#ymat<-try(solve(xmat))\n#deceta<- as.data.frame(tmat %*% ymat)\n#colnames(deceta) <- c(\"E0\",\"EC50\",\"TEQ\")\n\n\n#basiggofplot1(ModelName =\"All\" )\n#basiggofplot2(ModelName =\"All\" )\n#basiggofplot3(ModelName =\"All\" )\n#vpcplotpredcorr( PCDATAm=PCDATAm,ModelName =\"All\" )\n#npdeplot2( npdepredx=npdepredx,ModelName =\"All\" )\n#npdeplot( npdex=npdex,npdepredx=npdepredx,ModelName =\"All\" )\n\na<- basiggofplot1(ModelName =\"d.True model\\n Turnover PD\" )\nb<- basiggofplot2(ModelName =\"d.True model\\n Turnover PD\" )\nc<- basiggofplot3(ModelName =\"d.True model\\n Turnover PD\" ,logx=TRUE)\nd<- vpcplotpredcorr( PCDATAm=PCDATAmNOPRED,ModelName =\"d.True model\\n Turnover PD\" )\ne<- npdeplot1( npdex=npdex,ModelName =\"d.True model\\n Turnover PD\" )\nf<- npdeplot2(npdepredx=npdepredx,ModelName =\"d.True model\\n Turnover PD\",logx=TRUE )\nj<- individualfitsplot(gof=gof,ModelName =\"d.True model\\n Turnover PD\")\nh<- individualfitsplot2(richpredipred=richpredipred,\n                        ModelName =\"d.True model\\\\n Turnover PD\")\nplot(0,0,type=\"n\",axes=F,xlab=\"\",ylab=\"\")\ntext(0,0,\"True model\\n Turnover PD\")\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=FALSE) \ngrid.arrange(a,b,c,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(d,e,f,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(j,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(h,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n\n#graph2ppt(file=\"MOEV_plots2.pptx\", margins=0, upscale=TRUE, append=TRUE) \n#ggsave(\".\\\\figgoftrue.pdf\",figtrue,width=25,height=16.7,units=\"cm\",dpi=300)\n\na<- basiggofplot1(ModelName =\"a.Misspecified delay\\n Immediate effect\" )\nb<- basiggofplot2(ModelName =\"a.Misspecified delay\\n Immediate effect\" )\nc<- basiggofplot3(ModelName =\"a.Misspecified delay\\n Immediate effect\",logx=TRUE )\nd<- vpcplotpredcorr( PCDATAm=PCDATAmNOPRED,ModelName =\"a.Misspecified delay\\n Immediate effect\" )\ne<- npdeplot1( npdex=npdex,ModelName =\"a.Misspecified delay\\n Immediate effect\" )\nf<- npdeplot2(npdepredx=npdepredx,ModelName =\"a.Misspecified delay\\n Immediate effect\" ,logx=TRUE )\nj<- individualfitsplot(gof=gof,ModelName =\"a.Misspecified delay\\n Immediate effect\")\nh<- individualfitsplot2(richpredipred=richpredipred,\n                        ModelName =\"a.Misspecified delay\\\\n Immediate effect\")\n\nplot(0,0,type=\"n\",axes=F,xlab=\"\",ylab=\"\")\ntext(0,0,\"Misspecified delay\\n Immediate effect\")\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(a,b,c,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(d,e,f,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(j,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(h,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n#graph2ppt(file=\"MOEV_plots2.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n\na<- basiggofplot1(ModelName =\"b.Misspecified delay\\n Effect compartment\" )\nb<- basiggofplot2(ModelName =\"b.Misspecified delay\\n Effect compartment\" )\nc<- basiggofplot3(ModelName =\"b.Misspecified delay\\n Effect compartment\" ,logx=TRUE)\nd<- vpcplotpredcorr( PCDATAm=PCDATAmNOPRED,ModelName =\"b.Misspecified delay\\n Effect compartment\" )\ne<- npdeplot1( npdex=npdex,ModelName =\"b.Misspecified delay\\n Effect compartment\" )\nf<- npdeplot2(npdepredx=npdepredx,ModelName =\"b.Misspecified delay\\n Effect compartment\",logx=TRUE  )\nj<- individualfitsplot(gof=gof,ModelName =\"b.Misspecified delay\\n Effect compartment\")\nh<- individualfitsplot2(richpredipred=richpredipred,\n                        ModelName =\"b.Misspecified delay\\\\n Effect compartment\")\n\n\nplot(0,0,type=\"n\",axes=F,xlab=\"\",ylab=\"\")\ntext(0,0,\"Misspecified delay\\n Effect compartment\")\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(a,b,c,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(d,e,f,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(j,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(h,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n#graph2ppt(file=\"MOEV_plots2.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n\na<- basiggofplot1(ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\" )\nb<- basiggofplot2(ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\" )\nc<- basiggofplot3(ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\" ,logx=TRUE)\nd<- vpcplotpredcorr( PCDATAm=PCDATAmNOPRED,ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\" )\ne<- npdeplot1( npdex=npdex,ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\" )\nf<- npdeplot2(npdepredx=npdepredx,ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\" ,logx=TRUE )\nj<- individualfitsplot(gof=gof,ModelName =\"c.Misspecified delay and correlation\\n Effect compartment, Full Omega\")\nh<- individualfitsplot2(richpredipred=richpredipred,\n                        ModelName =\"c.Misspecified delay and correlation\\\\n Effect compartment, Full Omega\")\n\n\nplot(0,0,type=\"n\",axes=F,xlab=\"\",ylab=\"\")\ntext(0,0,\"Misspecified delay and correlation\\n Effect compartment, Full Omega\")\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(a,b,c,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(d,e,f,ncol=3)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(j,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \ngrid.arrange(h,ncol=1)\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n\n\nnpccal$Type <- factor(npccal$Type,\n                      levels=c(\"Upper PI Limit\",\"Lower PI Limit\"))\nNPCPLOT<- ggplot(npccal, aes(PI,Ratio))+\n  geom_hline(yintercept=1,linetype=\"dashed\")+\n  geom_point(aes(col=Outliers,pch=Outliers),size=5)+geom_line()+\n  geom_ribbon(aes(ymin=lwr,ymax=upr),alpha=0.1,fill=\"red\")+\n  facet_grid( Type ~ ModelName)+\n  scale_colour_manual(\"Outside the CI\",breaks=c(\"No\",\"Yes\"),values=c(\"black\",\"red\"))+\n  scale_shape_manual(\"Outside the CI\",breaks=c(\"No\",\"Yes\"),values=c(1,8))+\n  ylab(\"Observed/Expected\")+\n  xlab(\"Predictions Intervals\")+\n  theme(legend.position=\"bottom\")+\n  theme(text = element_text(size=20),\n        axis.text.x = element_text(angle=0, vjust=1))+\n  coord_cartesian(ylim=c(-0.5,3.5),xlim=c(-5,100))+\n  theme(panel.background= element_rect(fill = 'white', colour = 'black'))+\n  theme(legend.position=\"none\",axis.text=element_text(size=18),legend.title = element_blank(),\n        axis.title=element_text(size=18,face=\"bold\"))+\n  theme(panel.grid.minor = element_line(colour = \"gray\", linetype = \"dotted\"))+\n  theme(panel.grid.major= element_line(colour = \"gray\", linetype = \"solid\"))+\n  theme(strip.text = element_text(size = 10, colour = \"black\"),aspect.ratio=1)+\n  theme(text = element_text(size=20)) +\n  theme(panel.margin.x = grid::unit(1, \"lines\"))\n\nNPCPLOT\n\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n\ngpairs( eta1[,c(\"nBaseline\",\"nTeq\",\"nEC50\")], \n        upper.pars = list(conditional = 'boxplot', scatter = 'loess'),\n        lower.pars = list(scatter = 'stats',conditional = \"barcode\"),\n        diag.pars = list(fontsize = 9, show.hist = TRUE, hist.color = \"gray\"),\n        stat.pars =list(fontsize = 12, signif = 0.05, verbose = FALSE, use.color = TRUE, missing = 'missing', just = 'centre'),\n        scatter.pars = list(pch = 20))\n\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\neta2$nBaseline <- eta2$nE0\ngpairs( eta2[,c(\"nBaseline\",\"nEmax\",\"nEC50\")], \n        upper.pars = list(conditional = 'boxplot', scatter = 'loess'),\n        lower.pars = list(scatter = 'stats',conditional = \"barcode\"),\n        diag.pars = list(fontsize = 9, show.hist = TRUE, hist.color = \"gray\"),\n        stat.pars =list(fontsize = 12, signif = 0.05, verbose = FALSE, use.color = TRUE, missing = 'missing', just = 'centre'),\n        scatter.pars = list(pch = 20))\n\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \neta3$nBaseline <- eta3$nE0\n\ngpairs( eta3[,c(\"nBaseline\",\"nTeq\",\"nEC50\")], \n        upper.pars = list(conditional = 'boxplot', scatter = 'loess'),\n        lower.pars = list(scatter = 'stats',conditional = \"barcode\"),\n        diag.pars = list(fontsize = 9, show.hist = TRUE, hist.color = \"gray\"),\n        stat.pars =list(fontsize = 12, signif = 0.05, verbose = FALSE, use.color = TRUE, missing = 'missing', just = 'centre'),\n        scatter.pars = list(pch = 20))\n\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \neta4$nBaseline <- eta4$nE0\n\ngpairs( eta4[,c(\"nBaseline\",\"nTeq\",\"nEC50\")], \n        upper.pars = list(conditional = 'boxplot', scatter = 'loess'),\n        lower.pars = list(scatter = 'stats',conditional = \"barcode\"),\n        diag.pars = list(fontsize = 9, show.hist = TRUE, hist.color = \"gray\"),\n        stat.pars =list(fontsize = 12, signif = 0.05, verbose = FALSE, use.color = TRUE, missing = 'missing', just = 'centre'),\n        scatter.pars = list(pch = 20))\n\ngraph2ppt(file=\"MOEV_plots3.pptx\", margins=0, upscale=TRUE, append=TRUE) \n\n## we still need an augmented gof where we simulate ipred and pred at a grid of time points\n\n\n\n#unique(gof$ModelName)\n\n\n\n",
    "created" : 1473069704721.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3162831242",
    "id" : "DDE89041",
    "lastKnownWriteTime" : 1473071402,
    "last_content_update" : 1473071402222,
    "path" : "C:/Users/smouksas/Desktop/ACOP2014/MOEV/FINAL/PKPD_figures/tram/bymodelfigurs.R",
    "project_path" : "bymodelfigurs.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}